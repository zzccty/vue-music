# vue-music
> vue2.x + vue-router + vuex + jsonp + es6 + webpack 抓取QQ音乐真实数据的移动端音乐WebApp

# 技术栈

【前端】

- Vue: 用于构建用户界面的MVVM渐进式框架。它的核心是响应的数据绑定和组件系统
- vue-router: 为单页面应用提供的路由系统,项目上线前使用了 Lazy Loading Routes 技术来实现异步加载优化性能
- vuex: Vue集中状态管理,在多个组件共享某些状态时非常的便捷
- vue-lazyload: 第三方图片懒加载库,优化页面的加载速度和节约性能
- better-scroll: iscroll 的优化版,使移动端滑动体验更加流畅
- sass: css 预编译处理器。扩展了 CSS3，增加了规则、变量、混入、选择器、继承等等特性,生成良好格式化的 CSS 代码，易于组织和维护。
- ES6: ECMAScript 新一代语法,模块化、解构赋值、Promise、Class 等方法使用起来非常的好用

【后端】
- Node.js: 利用 Express 搭建一个本地测试服务器
- jsonp: 服务端通讯。 用于抓取qq音乐数据
- axios: 服务端通讯。 结合我们的Node.js代理后端请求,抓取我们qq音乐数据

【自动化构建工具】

- webpack: 项目编译打包工具
- vue-cl3: Vue脚手架工具, 可快速搭建项目
- eslint: 代码风格检查工具, 规范代码格式
- vConsole: 移动端调试工具, 在移动端输出日志

# 收获

1. 总结出一套适用于 Vue项目的通用组件
2. 总结了一套常用的 Sass mixin 库
3. 总结了一套常用的 JS 工具函数库
4. 学会了如何在Vue中优雅的操作Dom来完成优秀的用户交互体验

# 实现页面
主要页面: 推荐页,歌单详情页, 歌手页, 歌手详情页, 播放器内核页, 排行页, 搜索页, 添加歌曲页, 个人中心页

核心页面: 播放器内核页

## 推荐页

上部分是一个轮播图组件, 是一个基础组件,所以封装在 `base` 目录下, 使用了第三方库 `better-scroll` 辅助实现, 使用 `jsonp` 抓取了qq音乐数据

下部分是一个歌单推荐列表, 使用了 `axios` + `Node.js` 代理后端请求, 绕过qq音乐官方主机限制(伪造了 headers), 从而顺利的抓取了qq音乐的接口数据

歌单推荐列表图片, 使用了 `vue-lazyload`, 优化了页面加载速度

为了更好的提高用户体验, 当数据未请求到时, 加入了基础组件 `loading` 组件

## 推荐页 -> 歌单详情页

由于歌手的状态多且杂，这里使用 `vuex` 集中管理歌手状态

这个组件更加注重 UX，做了很多类原生 APP 动画，如下拉图片放大、跟随推动、ios 渐进增强的高斯模糊效果 `backdrop-filter` 等

## 歌手页

左右联动是这个组件的难点

左侧是一个歌手列表, 使用 `jsonp` 抓取qq音乐歌手数据并进行重组JSON 数据结构, 以获取我们所需要的数据格式

列表图片使用懒加载技术 `vue-lazyload`，优化页面加载速度

右侧是一个字母列表，与左侧歌手列表联动，滚动固定标题实现

## 歌手页 -> 歌手详情页

复用歌单详情页，只改变传入的参数，数据同样爬取自 QQ音乐

## 播放器内核页

核心组件。用 `vuex` 管理各种播放时的状态, 播放、暂停、切换下一首、切换上一首等功能调用 HTML5 audio API

播放器可以最大化和最小化

中部唱片动画使用第三方 JS 动画库 `create-keyframe-animation` 实现

底部操作区图标使用 `iconfonts`

抽象了一个横向进度条组件和一个圆形进度条组件。横向进度条可以拖动小球和点击进度条来改变播放进度，圆形进度条组件使用 `SVG <circle>` 元素

播放模式有：顺序播放、单曲循环、随机播放，原理是调整歌单列表数组

歌词的爬取利用 `axios` 代理后端请求，伪造 `headers` 来实现，先将歌词 `jsonp` 格式转换为 `json` 格式，再使用第三方库 `js-base64` 进行 `Base64` 解码操作，最后再使用第三方库 `lyric-parser` 对歌词进行格式化

实现了侧滑显示歌词、歌词跟随进度条高亮等交互效果

增加了当前播放列表组件，可在其中加入/删除歌曲

## 排行页

普通组件，获取数据通过 `jsonp` 获取数据, 渲染页面

## 排行页 -> 歌单详情页

复用歌单详情页，和歌手详情页类似

# 注意

此音乐播放器数据全部来自 QQ 音乐，接口改变了就需要修改 jsonp 和 axios 代码

# 安装与运行

```
git clone https://github.com/YeeLei/vue-music.git

cd vue-music

npm install //安装依赖

npm run serve //服务端运行 访问 http://localhost:8080

npm run build  //项目打包 
```

## 觉得有用的，欢迎各位来个star哦！
